% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/s3methods.R
\name{ggplot_build.ggplot_plus}
\alias{ggplot_build.ggplot_plus}
\title{Ggplot.Plus Build Method}
\usage{
\method{ggplot_build}{ggplot_plus}(plot)
}
\arguments{
\item{plot}{A \code{ggplot} object that carries the \code{"ggplot_plus"} class and a
\code{plot$ggplot_plus} intent list (typically set by \code{ggplot_add()} methods)}
}
\value{
A \code{ggplot_build} object (the same structure returned by
\code{ggplot2::ggplot_build()}), augmented with class \code{"ggplot_plus_built"}
to allow the package's gtable method to run next.
}
\description{
Package-specific build method that runs \strong{after} \code{ggplot2::ggplot_build()}
and before the gtable stage. It reads any intents stored under
\code{plot$ggplot_plus} (e.g., from \code{gridlines_plus()}) and applies them in a way
that respects ggplot2's "last merge wins" semantics.

Concretely, this method:
\itemize{
\item Adds major gridlines only along continuous axes (and blanks all minor
gridlines) by appending a theme element to \code{built$plot}.
\item Adjusts legend key appearance (e.g., make alphas opaque in keys,
ensure reasonable point/line sizes) by attaching guide overrides
to \code{built$plot} \emph{without} triggering a rebuild.
\item Emits a friendly warning when colour/fill are mapped to discrete
variables with many levels (default threshold = 8).
}
}
\details{
\strong{Order of operations}
\enumerate{
\item The \code{"ggplot_plus"} class is temporarily removed to avoid recursion, then
\code{ggplot2::ggplot_build(plot)} is called exactly once.
\item Intents are read from \code{plot$ggplot_plus}.
\item Gridlines: the method inspects trained scales/panel parameters to decide
which axes are continuous, then appends a \code{theme()} to \code{built$plot}
setting \verb{panel.grid.major.\{x,y\}} and blanking minor grids.
\item Legend overrides: if needed, \code{guides()} is appended to \code{built$plot}
with \code{guide_legend(override.aes = ...)} (and \code{guide_colourbar()} for
continuous colour/fill).
\item Discrete-level warning: for \code{colour}/\code{fill}, the trained scale is queried
and a warning is issued when the number of discrete levels exceeds a
threshold.
}

\strong{Why no rebuild?} By appending theme/guide intents to \code{built$plot} and
letting the gtable step realize them, we preserve ggplot2's usual layering
and keep performance predictable.
}
\examples{
\dontrun{
library(ggplot2)
p = ggplot2::ggplot(iris, ggplot2::aes(Sepal.Length, Petal.Length, colour = Species)) +
  geom_plus("point") +
  gridlines_plus()

# Building triggers this method:
b = ggplot_build(p)                    # S3 dispatch to ggplot_build.ggplot_plus
}

}
\seealso{
\code{\link[ggplot2:ggplot_build]{ggplot2::ggplot_build()}}, the package's gtable hook
\code{ggplot_gtable.ggplot_plus_built()}, and the intent setters:
\code{\link[=gridlines_plus]{gridlines_plus()}}, [geom_plus(), \code{\link[=yaxis_title_plus]{yaxis_title_plus()}}].
}
